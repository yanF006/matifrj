<%- include ('partials/header.ejs'); %>
<title>Exercicios - MATIFRJ</title>
<link rel="stylesheet" href="/CSS/exercicios.css">
<body>
    <%- include ('partials/navbar-aluno.ejs'); %>
    
    <div class="titulo">
      <h1>
          Atividade
      </h1>
  </div>


  <div class="container mt-4">
      <div class="row">
        <div class="col-12">
          <ul class="nav nav-tabs">
            <li class="nav-item">
              <button class="nav-link active" id="explicacao-tab" data-bs-toggle="tab" data-bs-target="#explicacao">Explicação</button>
            </li>
            <li class="nav-item">
              <button class="nav-link" id="atividades-tab" data-bs-toggle="tab" data-bs-target="#atividades">Atividades</button>
            </li>
          </ul>
          <div class="tab-content mt-3">
            <div class="tab-pane fade show active" id="explicacao">
              <div class="card">
                <div class="card-body">
                  <h1>
                 
                  <% conteudo.forEach(result => { %>
                    <h1><%= result.titulo %></h1>
                    <div><%- result.descricao %></div>
                  <% }) %>
                  
                </div>
              </div>
            </div>
             
          <div class="tab-content mt-3">
            <div class="tab-pane fade" id="atividades">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">Atividades</h5>

                  <% exercicios.forEach((result, index) => { %>
                    <div style="display: flex; align-items: center; gap: 8px;">
                      <strong><%= index + 1 %>)</strong>
                      <div><%- result.descricao %></div>
                    </div>
                  <% result.alternativas.forEach(alt => { %>
                  <input type="radio" name="pergunta<%=result.id%>" class="opcao" value="<%=alt.id%>"> <%= alt.conteudo %> <br>
                  <% }) %>
                  <% }) %>
                  <hr>
                 
                  
                  
                  <div class="enviar">
                    <button type="submit" style="margin-top: 20px;" class="btn btn-primary" onclick="verificarRespostas()" >Verificar respostas</button>
                </div>

                <div id="resultado" style="margin-top: 20px;"></div>
  <div id="totalCorretas" style="margin-top: 10px; font-weight: bold;"></div>
                </div>
              </div>
            </div>          
          </div>
        </div>
      </div>
    </div>
  
    <script src="/JS/script.js"></script>
   <script src="/JS/exerciciosAlunos.js"></script>
     <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"></script> -->
<script>
function verificarRespostas(){
  const respostasSelecionadas = []
  const opcaoselecionado = document.querySelectorAll('input[type="radio"]:checked')

  opcaoselecionado.forEach(opcao =>{
    respostasSelecionadas.push({
      perguntaId: opcao.name.replace('pergunta', ''),
      resposta: opcao.value // Obtém o valor da resposta selecionada
    });
    })
    console.log("Respostas Selecionadas:", respostasSelecionadas);
    verificarRespostasBackend(respostasSelecionadas);
  }
  



function verificarRespostasBackend(respostas) {
    fetch('/verificarRespostas', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ respostas })
    })
    .then(response => response.json())
    .then(data => {
      if (data.sucesso) {
                const resultadoDiv = document.getElementById('resultado');
                resultadoDiv.innerHTML = ''; // Limpa resultados anteriores

                data.respostas.forEach(resposta => {
                    const p = document.createElement('p');
                    p.innerText = resposta.mensagem;
                    p.style.color = resposta.correta ? 'green' : 'red'; // Verde para correto, vermelho para incorreto
                    resultadoDiv.appendChild(p);
                });

                const totalCorretas = data.respostas.filter(r => r.correta).length;
                document.getElementById('totalCorretas').innerText = `Você acertou ${totalCorretas} de ${data.respostas.length}`;
            } else {
                document.getElementById('resultado').innerText = "Erro ao processar respostas.";
            }
        })
        .catch(error => {
            console.error("Erro ao verificar respostas:", error);
        });
}
</script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script  defer id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</body>
<%- include ('partials/footer.ejs'); %>
